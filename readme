# Mini Wallet Service

Overview

Mini Wallet Service is a backend application built using **Node.js, Express, and MySQL**.  
It simulates a real-world wallet system that supports:

- User creation
- Wallet creation (one wallet per user)
- Credit money
- Debit money
- View wallet balance and last 10 transactions

The system is designed with a strong focus on:

- I. Data consistency  
- II. Concurrency handling  
- III. Idempotency  
- IV. Atomic transactions  

---

Tech Stack

## Node.js
## Express.js
## MySQL (InnoDB Engine)
## mysql2 (Promise-based driver)

---

 Architecture

Client â†’ Express API â†’ MySQL Database

The application uses:

- MySQL connection pooling
- Database-level constraints
- SQL transactions for atomic operations
- Row-level locking for concurrency control

---

# ğŸ—„ Database Design

The system contains three tables:

## 1 users
Stores user information.

- user_id (UNIQUE)
- user_name
- user_email (UNIQUE)
- user_phone (UNIQUE)
- created_at

## 2 wallets
Stores wallet balance.

- user_id (UNIQUE)
- balance (DECIMAL)
- created_at
- updated_at

One user â†’ One wallet (enforced using UNIQUE constraint).

## 3 transactions
Stores all credit/debit operations (including failed ones).

- transaction_id (UNIQUE)
- user_id
- type (CREDIT / DEBIT)
- amount
- status (SUCCESS / FAILED)
- reference_id (UNIQUE for idempotency)
- failure_reason
- created_at
---------------------------------------------------------
Recommended Testing Order

1ï¸âƒ£ Create User
2ï¸âƒ£ Create Wallet
3ï¸âƒ£ Credit Wallet
4ï¸âƒ£ Debit Wallet
5ï¸âƒ£ Get Wallet Details
-----------------------------------------------
endpoints& their payload
CREATE USER
ğŸ”¹ Endpoint :POST http://localhost:3000/users
request
{
  "userId": 1,
  "user_name": "Shefali Sethiya",
  "user_email": "shefali@email.com",
  "user_phone": "9876543210"
}
Headers
Content-Type: application/json
Body (JSON)
{
  "userId": 1,
  "user_name": "Shefali Sethiya",
  "user_email": "shefali@email.com",
  "user_phone": "9876543210"
}
Success Response (201)
{
  "message": "User created successfully",
  "user": {
    "userId": 1,
    "user_name": "Shefali Sethiya",
    "user_email": "shefali@email.com",
    "user_phone": "9876543210"
  }
}
CREATE WALLET
ğŸ”¹ Endpoint
POST /wallets

ğŸ”¹ Full URL
POST http://localhost:3000/wallets

ğŸ”¹ Headers
Content-Type: application/json

ğŸ”¹ Body (JSON)
{
  "userId": 1
}
Success Response (201)
{
  "message": "Wallet created successfully",
  "balance": 0
}
3ï¸âƒ£ CREDIT WALLET
ğŸ”¹ Endpoint
POST /wallets/:userId/credit

ğŸ”¹ Full URL
POST http://localhost:3000/wallets/1/credit

ğŸ”¹ Headers
Content-Type: application/json

ğŸ”¹ Body (JSON)
{
  "amount": 1000,
  "referenceId": "credit-ref-001"
}

âœ… Success Response (200)
{
  "message": "Wallet credited successfully",
  "balance": 1000
}
4ï¸âƒ£ DEBIT WALLET
ğŸ”¹ Endpoint
POST /wallets/:userId/debit

ğŸ”¹ Full URL
POST http://localhost:3000/wallets/1/debit

ğŸ”¹ Headers
Content-Type: application/json

ğŸ”¹ Body (JSON)
{
  "amount": 300,
  "referenceId": "debit-ref-001"
}

âœ… Success Response (200)
{
  "message": "Wallet debited successfully",
  "balance": 700
}

âŒ Failed (Insufficient Balance)
{
  "error": "Insufficient balance"
}
5ï¸âƒ£ GET WALLET DETAILS
ğŸ”¹ Endpoint
GET /wallets/:userId

ğŸ”¹ Full URL
GET http://localhost:3000/wallets/1

ğŸ”¹ Headers
Content-Type: application/json

ğŸ”¹ Body

âŒ No body required

âœ… Success Response (200)
{
  "userId": "1",
  "balance": 700,
  "transactions": [
    {
      "transaction_id": "uuid",
      "type": "DEBIT",
      "amount": 300,
      "status": "SUCCESS",
      "reference_id": "debit-ref-001",
      "failure_reason": null,
      "created_at": "2026-02-11T10:00:00.000Z"
    }
  ]
}
